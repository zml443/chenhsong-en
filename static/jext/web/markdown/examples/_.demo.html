<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="css/style.css" />
    <link rel="stylesheet" href="../css/editormd.preview.css" />
</head>
<body>
    <style>.editormd-preview-container, .editormd-html-preview{padding: 0;}</style>
    <div id="editormd-view"></div>
    <script src="js/jquery.min.js"></script>
    <script src="../lib/marked.min.js"></script>
    <script src="../lib/prettify.min.js"></script>
    
    <script src="../lib/raphael.min.js"></script>
    <script src="../lib/underscore.min.js"></script>
    <script src="../lib/sequence-diagram.min.js"></script>
    <script src="../lib/flowchart.min.js"></script>
    <script src="../lib/jquery.flowchart.min.js"></script>

    <script src="../editormd.js"></script>
    <script type="text/javascript">
        var WP = window.parent;
        var name = location.href.replace(/^(.*)markdown_name=(.*)$/, '$2');
        var el = WP.$("."+name);
        var option =
                {
                    markdown        : WP.$('.'+name).val(),//+ "\r\n" + $("#append-test").text(),
                    //htmlDecode      : true,       // 开启 HTML 标签解析，为了安全性，默认不开启
                    htmlDecode      : "style,script,iframe",  // you can filter tags decode
                    //toc             : false,
                    tocm            : true,    // Using [TOCM]
                    tocContainer    : "#custom-toc-container", // 自定义 ToC 容器层
                    //gfm             : false,
                    //tocDropdown     : true,
                    // markdownSourceCode : true, // 是否保留 Markdown 源码，即是否删除保存源码的 Textarea 标签
                    emoji           : true,
                    taskList        : true,
                    tex             : true,  // 默认不解析
                    flowChart       : true,  // 默认不解析
                    sequenceDiagram : true,  // 默认不解析
                };
        let html = editormd.markdownToHTML("editormd-view", option);

		let fn = WP.$.callbackfn(el.attr('fn'),'init')
        WP.$.eval(fn.init,html);
    </script>
</body>
</html>